## Pre-Work Validation

Before starting work, validate these three requirements:

### 1. TASK Identifier + DESCRIPTION
- **Required**: Task identifier (any format) OR detailed description
- **Format**: Flexible - accepts PROJ-123, repo-a3f, #456, sprint-5-auth, or description-only
- **Validation**: Description must be substantial (>10 characters, explains <%= typeof workType !== 'undefined' ? workType : 'bug and fix needed' %>)
- **If Missing**: EXIT with "ERROR: Need task identifier with description OR detailed <%= typeof workTypeShort !== 'undefined' ? workTypeShort : 'bug' %> description"

**Examples of VALID inputs:**
<% if (typeof exampleTasks !== 'undefined') { -%>
<% exampleTasks.forEach(function(task) { -%>
- <%= task %>
<% }); -%>
<% } else { -%>
- ✅ "TASK: PROJ-123, DESCRIPTION: Fix email validation for special characters in plus signs"
- ✅ "TASK: repo-a3f, DESCRIPTION: Fix OAuth token refresh race condition"
- ✅ "TASK: #456, DESCRIPTION: Fix null pointer in payment processing"
- ✅ "TASK: hotfix-payment, DESCRIPTION: Fix timeout errors in transaction processing"
<% } -%>

**Examples of invalid inputs (reject these):**
- ❌ "TASK: PROJ-123" (no description)
- ❌ "<%= typeof invalidExample !== 'undefined' ? invalidExample : 'DESCRIPTION: fix bug' %>" (too vague)

### 2. WORKTREE_PATH
- **Required Format**: ./trees/[task-id]-description
- **If Missing**: EXIT with "ERROR: Worktree path required (e.g., ./trees/PROJ-123-<%= typeof worktreeSuffix !== 'undefined' ? worktreeSuffix : 'fix' %>)"
- **Validation**: Path must exist and be under ./trees/ directory
- **Check**: Path must be accessible and properly isolated

### 3. DESCRIPTION (Detailed <%= typeof sectionTitle !== 'undefined' ? sectionTitle : 'Bug Information' %>)
- **Required**: Clear <%= typeof descriptionType !== 'undefined' ? descriptionType : 'bug description' %> via one of:
  - Direct markdown in agent prompt
  - File reference (e.g., @plan.md)
  - Ticket description/acceptance criteria (if using task tracking)
- **If Missing**: EXIT with "ERROR: <%= typeof missingError !== 'undefined' ? missingError : 'Bug description required (provide reproduction steps, expected vs actual behavior)' %>"
- **Validation**: Non-empty description explaining the <%= typeof validationText !== 'undefined' ? validationText : 'bug and expected fix approach' %>

**Jira integration (optional)**:
If TASK identifier matches Jira format (PROJ-123):
- Query ticket for additional context: `acli jira workitem view ${TASK}`
- Update status to "In Progress" if ticket exists
- Use acceptance criteria to guide <%= typeof guidanceType !== 'undefined' ? guidanceType : 'bug fix' %>

**Exit protocol**:
If any requirement is missing, exit immediately with a specific error message explaining what the user must provide to begin work.
