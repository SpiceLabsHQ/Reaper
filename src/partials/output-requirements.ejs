## Output Requirements
<% if (typeof isReviewAgent !== 'undefined' && isReviewAgent) { -%>
Return all analysis in your JSON response. Do not write separate report files.
- Do not write files to disk (<%= typeof reportFiles !== 'undefined' ? reportFiles : 'report files, analysis files, etc.' %>)
- Do not save <%= typeof saveType !== 'undefined' ? saveType : 'findings or analysis' %> to files
- All <%= typeof contentType !== 'undefined' ? contentType : 'analysis and findings' %> belong in the JSON response
- Include human-readable content in the "narrative_report" section
- Only read files for analysis — never write analysis files

**Examples:**
<% if (typeof reviewExamples !== 'undefined') { -%>
<% reviewExamples.forEach(function(ex) { -%>
- <%= ex %>
<% }); -%>
<% } else { -%>
- Correct: Read source code files and analyze quality
- Wrong: Write ANALYSIS_REPORT.md (return in JSON instead)
- Wrong: Write findings.json (return in JSON instead)
<% } -%>
<% } else { -%>
Return all reports and analysis in your JSON response. You may write code files, but not report files.
- You may write code files as needed (source files, test files, configs)
- Do not write report files (<%= typeof reportFiles !== 'undefined' ? reportFiles : 'bug-fix-report.md, test-results.json, etc.' %>)
- Do not save analysis outputs to disk — include them in the JSON response
- All analysis, metrics, and reports belong in the JSON response
- Include human-readable content in the "narrative_report" section

**Examples:**
<% if (typeof codeExamples !== 'undefined') { -%>
<% codeExamples.forEach(function(ex) { -%>
- <%= ex %>
<% }); -%>
<% } else { -%>
- Correct: Write src/auth.js (actual code fix)
- Correct: Write tests/auth.test.js (actual test code)
- Wrong: Write BUG_FIX_REPORT.md (return in JSON instead)
- Wrong: Write test-coverage.json (return in JSON instead)
<% } -%>
<% } -%>
<% if (typeof isOrchestrator !== 'undefined' && isOrchestrator) { -%>

### Orchestrator Extraction Rules

| Agent Category | Extract | Discard |
|---|---|---|
| **Coding** (feature-developer, bug-fixer, refactoring-dev) | `files_modified`, `work_completed` | narrative_report, verification_evidence, commands_executed |
| **Gate** (test-runner, code-reviewer, security-auditor, etc.) | `all_checks_passed`, `blocking_issues` | narrative_report, verification_evidence, detailed findings |
| **Planner** (workflow-planner) | Use compressed response directly | No extraction needed |

**Parallel gate handling:** When running Gate 2 agents in parallel, extract both `all_checks_passed` statuses. Retain `blocking_issues` only from failed gates.

Discard all other fields immediately after extraction. Do not carry full agent responses forward in context.
<% } -%>